---
layout: post
title: Bat技巧记载
category: 代码
tags: Bat 
keywords: Code Bat
typora-root-url: ..\..\..\
typora-copy-images-to: ..\..\..\public\zimage
---

## 简介
 * TOC
 {:toc}



##  .bat文件操作

### zshow.bat
```
@ECHO off
setlocal enabledelayedexpansion
set cur_path=%cd%           rem %cd% === 当前执行命令路径  C:\Users\zhuxx
echo cur_path=%cur_path%
set dp0=%~dp0              
echo dp0=%dp0%   rem %~dp0 === 当前执行文件的完整路径  C:\Users\zhuxx\Desktop\zbin\win_zbin\


echo userprofile=%userprofile%   rem userprofile 用户主目录  C:\Users\zhuxx

set input_0_param=%0
echo input_0_param=%0       rem %0 === 当前执行命令文件名称  zshow.bat
echo input_1_param=%1       rem %1 %2 %3 %4 %5 %6 %7 %8 %9   === 当前执行命令输入的第一个参数  
set number_str=0123456789

echo number_str=%number_str%       
set number_str_1=!number_str:~1!   rem 去掉前一个字符串
echo number_str_1=%number_str_1%   rem 123456789


set number_str_2=!number_str:~2!   rem 去掉前两个字符串
echo number_str_2=%number_str_2%   rem number_str_2=3456789

set number_str_3=!number_str:~3!   rem 去掉前三个字符串
echo number_str_3=%number_str_3%   rem number_str_3=456789


set number_str_0_4=!number_str:~0,4!  rem 取前四个字符串
echo number_str_0_4=%number_str_0_4%  rem number_str_0_4=1234


set number_str_2_5=!number_str:~2,5!  rem 取索引 2(索引0开始) 开始 后面5个字符串
echo number_str_2_5=%number_str_2_5%  rem  number_str_2_5=34567


set number_str_A=!number_str:~-1!  rem 只保留最后一个字符  ~-1  只保留最后一个字符
echo number_str_A(number_str:~-1)=%number_str_A%    rem  number_str_A(number_str:~-1)=9  


set number_str_B=!number_str:~-4!  rem 只保留最后四个字符  ~-4  只保留最后一个字符
echo number_str_B(number_str:~-4)=%number_str_B%    rem  number_str_B(number_str:~-4)=6789


rem for [参数] %%变量名 in （匹配符） do （执行的命令）  参数取值一共有四种： /d, /r, /l, /f，加上无参数，所以一共五种场景


echo ==================== for_1 no_param ====================
rem [1]无参：遍历当前路径的文件夹下的文件，但也可在(匹配符)中指定路径  查看 C:\Users\zhuxx 下 所有实体文件  
rem i == C:\Users\zhuzj5\.bash_history
rem i == C:\Users\zhuzj5\.gitconfig
rem i == C:\Users\zhuzj5\164.jpg
rem i == C:\Users\zhuzj5\Tip.txt
rem  进行运算后 自增一  必须使用 !! 括号括起来 

set /a Index_NoParam = 0
for  %%i in (%cd%\*) do (
set /a Index_NoParam+=1
echo no_param_index[!Index_NoParam!] == %%i
)
echo ==================== for_2 /d ====================
rem d_index[1] == C:\Users\zhuzj5\.android
rem d_index[2] == C:\Users\zhuzj5\.config
rem d_index[3] == C:\Users\zhuzj5\.dotnet
rem d_index[4] == C:\Users\zhuzj5\.eclipse


set /a Index_D = 0
for /d %%i in (%cd%\*) do (
set /a Index_D+=1
echo d_index[!Index_D!] == %%i
)


echo ==================== for_3 /r ====================
rem  /r [路径]：深度遍历指定路径下的所有文件，子目录中的文件也会被遍历到，如果没指定路径，默认当前路径  包含 文件 以及 文件夹
rem r_index[33601] == C:\Users\zhuxx\AppData\Local\FileZilla\
rem r_index[33602] == C:\Users\zhuxx\AppData\Local\FileZilla\\default_cancel30x30.png
rem r_index[33603] == C:\Users\zhuxx\AppData\Local\FileZilla\\default_cancel36x36.png

set /a Index_R = 0
for /r %%i in (%dp0%/*) do (
set /a Index_R+=1
echo r_index[!Index_R!] ======  %%i
)
echo ==================== for_3 /r *.bat ====================
set /a Index_R = 0
for /r  %%i in (%dp0%*.bat) do (
set /a Index_R+=1
echo r_index[!Index_R!] ======  %%i
)


echo ==================== for_4 /l ====================
rem for /l  循环  等效  for (int i = 1; i <= 5; i++)
for /l %%i in (1, 1, 5) do (
echo i == %%i             
)


echo ==================== for_4 /f ====================

rem for /f  用于解析文件中的内容  读取文件的每一行  空格之前的内容 
set /a Index_F = 0
for /f %%i in (%userprofile%\Desktop\zbin\A0.bat) do (
set /a Index_F+=1
echo f_index[!Index_F!] == %%i          
)





```